<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<style>
@font-face{
	font-family:'CODERROR';
	src:url('fonts/CODERROR.ttf')format('truetype');
	font-weight:normal;
	font-style:normal;
	font-display:block;
}
*{
	margin:0;
	padding:0;
	font-family:'CODERROR',monospace;
	letter-spacing:0;
	user-select:none;
	font-size:var(--symbol_size);
	pointer-events:auto; /* –†–∞–∑—Ä–µ—à–∏—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å HTML-—ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ */
}
html,body{
	width:100%;
	height:100%;
	margin:0;
	padding:0;
	overflow:hidden;
	background:#000;
}
body {
	display: flex;
	justify-content: center;
	align-items: center;
}
canvas{
	display:block;
	width:inherit;
	height:inherit;
}
#html-overlay{
	position:absolute;
	top:0;
	left:0;
	width: inherit;
	height: inherit;
	/*—á—Ç–æ–±—ã —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ —Ä–∞–±–æ—Ç–∞–ª–æ*/
	display: flex;
	flex-direction: column;
}
pre{
	color:#fff;
	background:#000;
	width:min-content;
	height:min-content;
	display:inline-block;
}
.center-horizontal{
	width:max-content;
	margin-left:auto;
	margin-right:auto;
}
.center-vertical {
	flex: 1 1 auto; /* –ó–∞–Ω–∏–º–∞–µ—Ç –≤—Å—ë –¥–æ—Å—Ç—É–ø–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ */
	display: flex;
	align-items: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
}
.center {
	flex: 1 1 auto; /* –ó–∞–Ω–∏–º–∞–µ—Ç –≤—Å—ë –¥–æ—Å—Ç—É–ø–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ */
	display: flex;
	align-items: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
	justify-content: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ */
}
.column{
	flex-direction:column;
}
button{
	background-color:transparent;
	color:#fff;
	border: none;
	cursor: pointer !important;
	outline: none;
}
.drop_zone {
	width:calc(var(--symbol_size) * 12);
	height:calc(var(--symbol_size) * 12);
	background:#00000066;
}
.scrollable{
	overflow-y:scroll;
	overflow-x:scroll;
	width:100%;
	height:100%;
	scrollbar-color:#fff #000;
}
#wrapper{
	position:relative;
}
select{
	background:#000;
	color:#fff;
	outline:none;
	border:none;
}
/* –î–ª—è –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ */
select option{
	background:#000;
	color:#fff;
}
.wrap{
	flex-wrap:wrap;
}
textarea{
	background-color:#000;
	color:#fff;
	border:0px solid #fff;
	border-radius:0;
	white-space:normal;
	overflow-wrap:break-word;
	outline:none;
	::placeholder{
		color:#c8c8c8;
		opacity:1;
	}
	&:focus {
		border-color:#f0f;
		box-shadow:none;
	}
}
input[type="range"]{
	accent-color:#f0f;
}
	</style>
	<link rel="icon" type="image/png">
</head>
<body>
	<div id="wrapper"></div>
	<script>
//–ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ –æ–∫–Ω–æ –æ—Å–Ω–æ–≤–Ω—ã–º
if(!window.location.search.includes('child=1')){
	//–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –Ω–æ–≤–æ–≥–æ –æ–∫–Ω–∞
	const width=800;
	const height=600;
	const features=`width=${width},height=${height},left=${(screen.width-width)/2},top=${(screen.height-height)/2}`;
	//–ü—ã—Ç–∞–µ–º—Å—è –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤–æ–µ –æ–∫–Ω–æ
	const new_window=window.open(`${window.location.href}?child=1`,'_blank',features);
	if(new_window){
		// –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ç–µ–∫—É—â–µ–µ –æ–∫–Ω–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è
		window.close();
	}else{
		// –ü—Ä–æ–≤–µ—Ä—è–µ–º –±—Ä–∞—É–∑–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
		const is_chrome=/Chrome/.test(navigator.userAgent)&&!/Edg|Edge/.test(navigator.userAgent);
		let chrome_alert='';
		if(!is_chrome){
			chrome_alert=`
				<div style="padding: 15px; color: #000; background: #ffeb3b; margin-bottom: 10px; border-radius: 4px;">
					–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å –≤ Google Chrome: 
					<a href="https://www.google.com/intl/ru_ru/chrome/" 
					target="_blank" 
					style="color: #ff00ff; text-decoration: underline;">
						https://www.google.com/intl/ru_ru/chrome/
					</a>
				</div>`;
		}
		// –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
		document.body.innerHTML=chrome_alert+`
			<div style="padding: 20px; color: white; background: #d32f2f; border-radius: 4px;">
				–†–∞–∑—Ä–µ—à–∏—Ç–µ –≤—Å–ø–ª—ã–≤–∞—é—â–∏–µ –æ–∫–Ω–∞ –¥–ª—è —ç—Ç–æ–≥–æ —Å–∞–π—Ç–∞ –∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É!
			</div>`;
	}
}else{
	//–ï—Å–ª–∏ —ç—Ç–æ –¥–æ—á–µ—Ä–Ω–µ–µ –æ–∫–Ω–æ - –∑–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
	/*—Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞*/
	function load_script(src){
		return new Promise((resolve,reject)=>{
			const script=document.createElement('script');
			script.src=src;
			script.onload=()=>resolve(src);
			script.onerror=()=>reject(new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞: ${src}`));
			document.head.appendChild(script);
		});
	}
	//–ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ —à—Ä–∏—Ñ—Ç–∞
	const font=new FontFace('CODERROR','url(fonts/CODERROR.ttf)');
	font.load().then(function(loadedFont){
		document.fonts.add(loadedFont);
		/*–∑–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤*/
		Promise.all([
			load_script('scripts/pixi.min.js'),
			load_script('initial_settings.js'),
			load_script('languages.js')
		])
		.then((loaded_scripts)=>{
			/*–Ω–∞—á–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã*/
			const app=new PIXI.Application({
				backgroundColor:0x000000
			});
			app.init().then(()=>{
				let wrapper=document.getElementById('wrapper');
				/*–≤–µ—Ä—Å–∏—è CODERROR'–∞*/
				window.version='(1)0.21.0';
				/*–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Ä–∞–∑–º–µ—Ç–∫—É canvas-–∞ pixijs*/
				wrapper.appendChild(app.view);
				/*–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Ä–∞–∑–º–µ—Ç–∫—É html-overlay*/
				const overlay=document.createElement('div');
				overlay.id='html-overlay';
				wrapper.appendChild(overlay);
				/**/
				let room,preparation;
				function change_room(room_,preparation_=true,reset_overlay_=true){
					room=room_;
					preparation=preparation_;
					if(reset_overlay_){
						overlay.innerHTML=``;
					}
				}
				let symbols_grid=[];//–¥–≤—É–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ –¥–ª—è —Å–∏–º–≤–æ–ª–æ–≤
				let columns=0;
				let rows=0;
				function update_symbols_grid(){
					columns=Math.ceil(app.renderer.width/symbol_size);
					rows=Math.ceil(app.renderer.height/symbol_size);
					// –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —Å–∏–º–≤–æ–ª—ã
					symbols_grid.forEach(row=>{
						row.forEach(symbol=>symbol.destroy());
					});
					symbols_grid=[];// –°–±—Ä–∞—Å—ã–≤–∞–µ–º –º–∞—Å—Å–∏–≤
					// –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Å–µ—Ç–∫—É
					for(let y=0;y<rows;y++){
						symbols_grid[y]=[];
						for(let x=0;x<columns;x++){
							const symbol=new PIXI.Text('',text_style);
							symbol.resolution=20;
							symbol.position.set(x*symbol_size,y*symbol_size);
							app.stage.addChild(symbol);
							symbols_grid[y][x]=symbol;
						}
					}
				}
				/*–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —à—Ä–∏—Ñ—Ç–æ–≤*/
				const styleSheet=document.styleSheets[0];
				let symbol_size,font_size,text_style,pixel_in_pt=0.675;
				function set_font_size(size_in_pixels){
					symbol_size=size_in_pixels;
					font_size=symbol_size*pixel_in_pt;
					styleSheet.insertRule(":root{--symbol_size:"+font_size+"pt !important;}",styleSheet.cssRules.length);
					text_style=new PIXI.TextStyle({
						fontFamily:'CODERROR',
						fontSize:symbol_size,
						trim:false,
						fill:0xFFFFFF,
					});
					update_symbols_grid();
				}
				set_font_size(10);
				/**/
				const update_size=()=>{
					app.renderer.resize(wrapper.clientWidth,wrapper.clientHeight);
					update_symbols_grid();
				};
				function visual_effect(number){
					/*–∑–∞–ø–æ–ª–Ω—è–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏*/
					if(number==0){
						for(let y=0;y<symbols_grid.length;y++){
							for(let x=0;x<symbols_grid[y].length;x++){
								const symbol=symbols_grid[y][x];
								symbol.text=get_random_char();
								symbol.tint=get_random_color();
							}
						}
					}
					/*—Å–ª—É—á–∞–π–Ω–æ –ø–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç —Å–∏–º–≤–æ–ª—ã*/
					if(number==1){
						for(let y=0;y<symbols_grid.length;y++){
							for(let x=0;x<symbols_grid[y].length;x++){
								const symbol=symbols_grid[y][x];
								symbol.anchor.set(Math.random());
								symbol.rotation=Math.random();
							}
						}
					}
					/*–æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–π*/
					if(number==2){
						for(let y=0;y<symbols_grid.length;y++){
							for(let x=0;x<symbols_grid[y].length;x++){
								const symbol=symbols_grid[y][x];
								symbol.anchor.set(0);
								symbol.rotation=0;
							}
						}
					}
				}
				function get_random_char(){
					return String.fromCharCode(Math.floor(Math.random()*(126-33+1))+33);
				}
				function get_random_color(){
					return Math.floor(Math.random()*0xFFFFFF);
				}
				//–¥–ª—è –∏–∫–æ–Ω–∫–∏
				const dpr=window.devicePixelRatio||1;
				const favicon_size=Math.round(16*dpr);
				const canvas=document.createElement('canvas');
				canvas.width=favicon_size;
				canvas.height=favicon_size;
				const ctx=canvas.getContext('2d');
				ctx.font=`${symbol_size}px CODERROR`;
				ctx.textAlign='center';
				ctx.textBaseline='middle';
				const link=document.querySelector('link[rel="icon"]');
				function generate_favicon(){
					// –û—á–∏—â–∞–µ–º —Ö–æ–ª—Å—Ç
					ctx.clearRect(0,0,favicon_size,favicon_size);
					// –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–∫—Å—Ç–∞
					ctx.fillStyle=`#${get_random_color().toString(16).padStart(6,'0')}`;
					// –†–∏—Å—É–µ–º —Å–∏–º–≤–æ–ª
					ctx.fillText(get_random_char(),favicon_size/2,favicon_size/2);
					// –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É
					canvas.toBlob(blob=>{
						link.href=URL.createObjectURL(blob);
					},'image/png');
				}
				window.addEventListener('resize',update_size);
				/*–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ favicon*/
				const faviconInterval=setInterval(()=>{
					generate_favicon();
				},1000/5);
				/*—Ñ—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞ —Ä–∞–∑–º–µ—Ç–∫–∏ pre —Å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º —Ñ–æ–Ω–∞ —É –ø—Ä–æ–±–µ–ª–æ–≤*/
				function get_transparent_space_text(text,color='#fff',background='#000'){
					const escapeHtml=(char)=>{
						const escapes={
							'<':'&lt;',
							'>':'&gt;',
							'&':'&amp;',
							'"':'&quot;',
							"'":'&#39;'
						};
						return escapes[char]||char;
					};
					const areStylesEqual=(a,b)=>{
						const aKeys=Object.keys(a);
						const bKeys=Object.keys(b);
						if(aKeys.length!==bKeys.length)return false;
						for(const key of aKeys){
							if(a[key]!==b[key])return false;
						}
						return true;
					};
					const tokenRegex=/(‚¶ë[^‚¶í]*‚¶í)|(\n)|( )|(.)/g;
					const tokens=[];
					let match;
					while((match=tokenRegex.exec(text))!==null){
						if(match[1])tokens.push({type:'tag',value:match[1]});
						else if(match[2])tokens.push({type:'newline'});
						else if(match[3])tokens.push({type:'space'});
						else if(match[4])tokens.push({type:'char',value:match[4]});
					}
					const initialStyles={color,background};
					let currentStyles={...initialStyles};
					let output=[];
					let currentNonSpace={styles:null,content:[]};
					let currentSpace=[];
					const flushNonSpace=()=>{
						if(currentNonSpace.content.length===0)return;
						// –í—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ, –µ—Å–ª–∏ —Å—Ç–∏–ª–∏ –Ω–µ –∏–∑–º–µ–Ω–µ–Ω—ã
						const baseStyles={color:'inherit',background:'inherit'};
						const mergedStyles=!areStylesEqual(currentNonSpace.styles,initialStyles) 
							?{...currentNonSpace.styles}
							:baseStyles;
						const styleStr=`style="${Object.entries(mergedStyles).map(([k,v])=>`${k}:${v}`).join(';')}"`;
						const content=currentNonSpace.content.map(escapeHtml).join('');
						output.push(`<pre ${styleStr}>${content}</pre>`);
						currentNonSpace.content=[];
						currentNonSpace.styles=null;
					};
					const flushSpace=()=>{
						if(currentSpace.length===0)return;
						// –¢–æ–ª—å–∫–æ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω –∏ —Ü–≤–µ—Ç –µ—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω
						const spaceStyles={
							background:'transparent',
							...(currentStyles.color!==initialStyles.color&&{color:currentStyles.color})
						};
						const styleStr=Object.keys(spaceStyles).length>0 
							?`style="${Object.entries(spaceStyles).map(([k,v])=>`${k}:${v}`).join(';')}"`
							:'';
						const content=currentSpace.map(escapeHtml).join('');
						output.push(`<pre ${styleStr}>${content}</pre>`);
						currentSpace=[];
					};
					for(const token of tokens){
						switch(token.type){
							case'tag':{
								const tagContent=token.value.slice(1,-1).trim();
								if(tagContent==='reset'){
									currentStyles={...initialStyles};
								}else{
									const[property,value]=tagContent.split(':').map(p=>p.trim());
									if(property&&value)currentStyles[property]=value;
								}
								flushNonSpace();
								flushSpace();
								break;
							}
							case'newline':
								flushNonSpace();
								flushSpace();
								output.push('<br>');
								break;
							case'space':
								flushNonSpace();
								currentSpace.push(' ');
								break;
							case'char':
								flushSpace();
								if(currentNonSpace.styles&&areStylesEqual(currentStyles,currentNonSpace.styles)){
									currentNonSpace.content.push(token.value);
								}else{
									flushNonSpace();
									currentNonSpace.styles={...currentStyles};
									currentNonSpace.content.push(token.value);
								}
								break;
						}
					}
					flushNonSpace();
					flushSpace();
					return`<div style="display:contents;color:${color};background:${background}">${output.join('')}</div>`;
				}
				/*–ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–∞–∑–º–µ—Ç–∫—É, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç*/
				function create_element_from_HTML(html){
					const template=document.createElement('template');
					template.innerHTML=html.trim();
					const fragment=template.content;
					// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω –¥–æ—á–µ—Ä–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç
					if(fragment.childNodes.length===1&&fragment.firstChild.nodeType===Node.ELEMENT_NODE){
						return fragment.firstChild;
					}else{
						// –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å display: contents
						const container=document.createElement('div');
						container.style.display='contents';
						// –ü–µ—Ä–µ–º–µ—â–∞–µ–º –≤—Å–µ —É–∑–ª—ã –∏–∑ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
						while(fragment.firstChild){
							container.appendChild(fragment.firstChild);
						}
						return container;
					}
				}
				/*–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–∏–Ω –∏–∑ –ò–°–¢–ò–ù–´–• —Ü–≤–µ—Ç–æ–≤*/
				function get_random_true_str_color(){
					const colors=['#000','#00f','#0f0','#0ff','#f00','#f0f','#ff0','#fff'];
					return colors[Math.floor(Math.random()*colors.length)];
				}
				/*—É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç z-index –Ω–∞ 1*/
				function increment_z_index(element){
					element.style.zIndex=parseInt(element.style.zIndex||0)+1+'';
				}
				/*–æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –≤ –∫–Ω–æ–ø–∫—É —Å —Å–∏–º–≤–æ–ª—å–Ω–æ–π —Ä–∞–º–∫–æ–π*/
				function wrap_in_frame(content,container_type='<button/>',removable=false) {
					let button = create_element_from_HTML(container_type);
					button.style.position='relative';
					button.style.overflow='hidden';
					let grid=document.createElement('div');
					grid.style.display='grid';
					grid.style.gridTemplateAreas=`"a . b" ". c ." "d . e"`;
					grid.style.gridTemplateColumns='repeat(3,min-content)';
					grid.style.gridTemplateRows='repeat(3,min-content)';
					grid.style.gap='0';
					grid.style.position='relative';
					grid.style.alignItems='center'; // –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ —Ü–µ–Ω—Ç—Ä—É
					grid.style.justifyItems='center';
					grid.style.color='inherit';
					// –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –æ–±–ª–∞—Å—Ç—è–º–∏
					let b;
					if(removable){
						b=create_element_from_HTML(`<pre><button style='color:inherit'>X</button></pre>`);/*–∫–æ—Å—Ç—ã–ª—å*/
						b.addEventListener('click',()=>{
							button.remove();
						});
					}
					else{
						b=create_element_from_HTML(`<pre>.</pre>`);
					}
					const elements={
						a:create_element_from_HTML(`<pre>+</pre>`),
						b:b,
						c:document.createElement('div'),
						d:create_element_from_HTML(`<pre>\`</pre>`),
						e:create_element_from_HTML(`<pre>'</pre>`)
					};
					// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
					elements.c.appendChild(content);
					elements.c.style.gridArea='c';
					elements.c.style.whiteSpace='nowrap';
					elements.c.id='frame_content';
					// –ü—Ä–∏–≤—è–∑–∫–∞ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫ grid-areas
					Object.entries(elements).forEach(([area,el])=>{
						el.style.gridArea=area;
						el.style.color='inherit';
						grid.appendChild(el);
					});
					if(removable){
						b.style.color='#f00'
					}
					button.appendChild(grid);
					increment_z_index(grid);
					let horizontal=`<pre style="position:absolute;white-space:nowrap;color:inherit;">${'-'.repeat(666)}</pre>`
					let vertical=`<pre style="position:absolute;white-space:nowrap;color:inherit;">${'|<br>'.repeat(444)}</pre>`
					let top=create_element_from_HTML(horizontal);
					top.style.top=0;
					top.style.left=0;
					let bottom=create_element_from_HTML(horizontal);
					bottom.style.bottom=0;
					bottom.style.left=0;
					let left=create_element_from_HTML(vertical);
					left.style.top=0;
					left.style.left=0;
					let right=create_element_from_HTML(vertical);
					right.style.top=0;
					right.style.right=0;
					button.appendChild(top);
					button.appendChild(bottom);
					button.appendChild(left);
					button.appendChild(right);
					return button;
				}
				/*—Å–æ–∑–¥–∞–µ—Ç –∫–Ω–æ–ø–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–∞*/
				function create_button_from_text(text,removable=false){
					return wrap_in_frame(create_element_from_HTML(get_transparent_space_text(text)),'<button/>',removable);
				}
				/*–º–µ–Ω—è–µ—Ç —Ü–≤–µ—Ç —Ä–∞–º–∫–∏ –∫–Ω–æ–ø–∫–∏*/
				function change_button_border_color(button,color){
					button.style.color=color;
				}
				/*–º–µ–Ω—è–µ—Ç —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –∫–Ω–æ–ø–∫–∏*/
				function change_button_text_color(button,color){
					const targetElement=button.querySelector('#frame_content');
					const firstChild=targetElement.firstElementChild;
					if(firstChild){
						firstChild.style.color=color;
					}else{
						console.log('–£ —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–µ—Ç –¥–æ—á–µ—Ä–Ω–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.');
					}
				}
				/*–º–µ–Ω—è–µ—Ç —Ü–≤–µ—Ç —Ä–∞–º–∫–∏ –∏ —Ç–µ–∫—Å—Ç–∞ –∫–Ω–æ–ø–∫–∏*/
				function change_button_color(button,color){
					change_button_border_color(button,color);
					change_button_text_color(button,color);
				}
				/*–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞—é—Ç –ª–∏ —Ñ–∞–π–ª –Ω–∞–¥ –æ–±—ä–µ–∫—Ç–æ–º*/
				const dragoverStates=new WeakMap();
				function check_dragover(element){
					if (!element.__dragoverHandlersAdded){
						const handlers={
							dragenter:(event)=>{
								event.preventDefault();
								if(!dragoverStates.get(element)){
									element.classList.add('dragover');
									dragoverStates.set(element,true);
								}
							},
							dragover:(event)=>{
								event.preventDefault();
								if(!dragoverStates.get(element)){
									element.classList.add('dragover');
									dragoverStates.set(element,true);
								}
							},
							dragleave:(event)=>{
								if(!event.relatedTarget||!element.contains(event.relatedTarget)){
									element.classList.remove('dragover');
									dragoverStates.set(element,false);
								}
							},
							drop:(event)=>{
								event.preventDefault();
								element.classList.remove('dragover');
								dragoverStates.set(element,false);
							}
						};
						element.addEventListener('dragenter',handlers.dragenter);
						element.addEventListener('dragover',handlers.dragover);
						element.addEventListener('dragleave',handlers.dragleave);
						element.addEventListener('drop',handlers.drop);
						element.__dragoverHandlersAdded=true;
						Object.assign(element,{__dragoverHandlers:handlers});
					}
					return dragoverStates.get(element)||false;
				}
				/*–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–≤–µ–¥–µ–Ω–∞ –ª–∏ –º—ã—à—å –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç*/
				function check_hover(element){
					return(element.matches(':hover')||check_dragover(element));
				}
				/*–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π br —ç–ª–µ–º–µ–Ω—Ç*/
				function get_br(){
					return document.createElement('br');
				}
				/*–ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç json —Ñ–∞–π–ª –≤ –æ–±—ä–µ–∫—Ç (—Ç—Ä–µ–±—É–µ—Ç async await)*/
				function json_to_dict(file){
					return new Promise((resolve,reject)=>{
						const reader=new FileReader();
						reader.onload=e=>{
							try{
								resolve(JSON.parse(e.target.result));
							}catch(error){
								reject(error);
							}
						};
						reader.onerror=error=>reject(error);
						reader.readAsText(file);
					});
				}
				/*–ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –º–Ω–æ–≥–æ json –≤ –æ–±—ä–µ–∫—Ç—ã –∑–∞ —Ä–∞–∑*/
				async function jsons_to_dict_list(files){
					let data=[];
					for(let file of files){
						const parsed=await json_to_dict(file);
						data.push(parsed);
					}
					return data;
				}
				/*—Å–æ–µ–¥–∏–Ω—è–µ—Ç –æ–±—ä–µ–∫—Ç—ã –≤ 1 –±–æ–ª–µ–µ –æ–±—â–∏–π, –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—è —Å—Ç–∞—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–æ–≤—ã–º–∏*/
				function smart_merge(config_list,max_depth=2){
					// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ —Å–ª–∏—è–Ω–∏—è —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –≥–ª—É–±–∏–Ω—ã
					const merge=(target,source,depth=1)=>{
						// –ï—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–ª–∏ –ø—Ä–µ–¥–µ–ª–∞ –≥–ª—É–±–∏–Ω—ã - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º source
						if(depth>=max_depth)return{...source};
						// –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
						const result={...target};
						// –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –∫–ª—é—á–∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
						for(const key of Object.keys(source)) {
							const sourceValue=source[key];
							const targetValue=target[key];
							// –ï—Å–ª–∏ –æ–±–∞ –∑–Ω–∞—á–µ–Ω–∏—è - –æ–±—ä–µ–∫—Ç—ã (–Ω–µ –º–∞—Å—Å–∏–≤—ã) 
							if(typeof sourceValue==='object'&& 
								!Array.isArray(sourceValue)&&
								typeof targetValue==='object'&& 
								!Array.isArray(targetValue)){
								// –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Å–ª–∏—è–Ω–∏–µ —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –≥–ª—É–±–∏–Ω—ã
								result[key]=merge(targetValue,sourceValue,depth+1);
							}else{
								// –ó–∞–º–µ–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
								result[key]=sourceValue;
							}
						}
						return result;
					};
					let result=config_list[0];
					for(let i=1;i<config_list.length;i++){
						result=merge(result,config_list[i]);
					}
					return result;
				}
				/*—Å–æ–∑–¥–∞—ë—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π*/
				const eventHandlers=new WeakMap();
				function add_event_listener(name,element,function_part){
					/*–£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö*/
					remove_event_listener(name,element);
					const handlers={
						drop:null,
						click:null,
						change:null
					};
					if(name==='get_json'){
						const jsonInput=document.createElement('input');
						jsonInput.type='file';
						jsonInput.multiple=true;
						jsonInput.accept='.json';
						jsonInput.style.display='none';
						/*–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è drag-and-drop*/
						const dropHandler=async(e)=>{
							e.preventDefault();
							try{
								const dicts=await jsons_to_dict_list(e.dataTransfer.files);
								const merged=smart_merge(dicts);
								function_part(merged);
							}catch(error){
								console.error('–û—à–∏–±–∫–∞:',error);
							}
						};
						/*–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–ª–∏–∫–∞ (–æ—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–∞)*/
						const clickHandler=()=>{
							jsonInput.click();
						};
						/*–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤ (–æ–±—â–∏–π –¥–ª—è –≤—Å–µ—Ö –≤—ã–∑–æ–≤–æ–≤)*/
						const changeHandler=async(e)=>{
							try{
								const files=Array.from(e.target.files);
								const dicts=await jsons_to_dict_list(files);
								const merged=smart_merge(dicts);
								function_part(merged);
								jsonInput.value='';
							}catch(error){
								console.error('–û—à–∏–±–∫–∞:',error);
							}
						};
						/*–°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏*/
						handlers.drop=dropHandler;
						handlers.click=clickHandler;
						handlers.change=changeHandler;
						/*–ù–∞–≤–µ—à–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏*/
						element.addEventListener('drop',dropHandler);
						element.addEventListener('click',clickHandler);
						jsonInput.addEventListener('change',changeHandler);
						/*–°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–π input –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏*/
						eventHandlers.set(element,{
							name,
							handlers,
							elements:{jsonInput}
						});
					}
				}
				/*—É–¥–∞–ª—è–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π*/
				function remove_event_listener(name,element){
					const stored=eventHandlers.get(element);
					if(stored&&stored.name===name){
						/*–£–¥–∞–ª—è–µ–º –≤—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π*/
						element.removeEventListener('drop',stored.handlers.drop);
						element.removeEventListener('click',stored.handlers.click);
						stored.elements.jsonInput.removeEventListener('change',stored.handlers.change);
						/*–£–¥–∞–ª—è–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–π input –∏–∑ DOM –µ—Å–ª–∏ –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω*/
						if(document.body.contains(stored.elements.jsonInput)){
							document.body.removeChild(stored.elements.jsonInput);
						}
						eventHandlers.delete(element);
					}
				}
				/*—Å–æ–∑–¥–∞–µ—Ç hr –∏–∑ -*/
				function get_symbolic_hr(){
					return create_element_from_HTML(`<div style='overflow:hidden;width:100%;height:max-content'><pre style='white-space:nowrap'>${'-'.repeat(666)}</pre></div>`);
				}
				/*–ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞–∑–≤–∞–Ω–∏–π —è–∑—ã–∫–æ–≤ –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∏—Ö (—á–µ–º –±–æ–ª—å—à–µ –∏–Ω–¥–µ–∫—Å, —Ç–µ–º –≤—ã—à–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)*/
				function apply_language(name_list){
					name_list=['default'].concat(name_list);
					let languages_list=[];
					for(name of name_list){
						languages_list.push(window.languages[name]);
					}
					window.language=smart_merge(languages_list,99);
				}
				/*–ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Ç–µ–∫—Å—Ç–∞ –∏ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –≤ –∫–Ω–æ–ø–∫–∏*/
				function dict_to_buttons(dict){
					let buttons=structuredClone(dict);
					for(let key in buttons){
						buttons[key]=create_button_from_text(buttons[key]);
					}
					return buttons;
				}
				/*—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∏–≥—Ä—ã, "100%" –æ—Ç–∫–ª—é—á–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ*/
				function set_max_content_size(max_width,max_height){
					wrapper.style.width=`min(100%,${max_width})`;
					wrapper.style.height=`min(100%,${max_height})`;
					update_size();
				}
				/*–ø—Ä–∏–Ω–∏–º–∞–µ—Ç select –∏ —Å–ø–∏—Å–æ–∫ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –µ–º—É —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è*/
				function set_select_options(selectElement,options) {
					selectElement.innerHTML='';
					options.forEach(optionText=>{
						let option=document.createElement('option');
						//option.value=optionText;// –ó–∞–¥–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
						option.textContent=optionText;// –ó–∞–¥–∞–µ–º —Ç–µ–∫—Å—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
						selectElement.appendChild(option);
					});
				}
				/*—Å–æ–∑–¥–∞–µ—Ç select —Å —Ä–∞–º–∫–æ–π*/
				function create_select_with_frame(options,removable=false){
					let select=create_element_from_HTML('<select/>');
					set_select_options(select,options);
					select.style.margin='calc(-1 * var(--symbol_size))';
					select.style.padding='var(--symbol_size)';
					select.style.marginRight='0';
					select.style.cursor='pointer';
					select.style.background='#00000000';
					let frame=wrap_in_frame(select,`<button style='background:#000;'/>`,removable);
					frame.style.pointerEvents='none';
					return[frame,select];
				}
				/*—Å–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π –ø—Ä–æ–±–µ–ª –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç—Å—Ç—É–ø–∞*/
				function get_space(){
					return create_element_from_HTML(`<pre style='background:#00000000'> </pre>`);
				}
				/* –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∫–∞–∫ JSON —Ñ–∞–π–ª*/
				function save_as_json(data,filename){
					// –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ–±—ä–µ–∫—Ç –≤ JSON —Å—Ç—Ä–æ–∫—É
					const jsonString=JSON.stringify(data);
					// –°–æ–∑–¥–∞–µ–º Blob –∏–∑ JSON —Å—Ç—Ä–æ–∫–∏
					const blob=new Blob([jsonString],{type:"application/json"});
					// –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –æ–±—ä–µ–∫—Ç Blob
					const url=URL.createObjectURL(blob);
					// –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
					const a=document.createElement("a");
					a.href=url;
					a.download=filename;
					a.style.display='none';
					// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–ª–∏–∫ –ø–æ —Å—Å—ã–ª–∫–µ
					document.body.appendChild(a);
					a.click();
					// –£–¥–∞–ª—è–µ–º —Å—Å—ã–ª–∫—É –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º URL
					document.body.removeChild(a);
					URL.revokeObjectURL(url);
					/*—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ*/
					alert(window.language.alerts.file_saved(filename));
				}
				/*—É–¥–∞–ª—è–µ—Ç –∏–∑ —Å–ø–∏—Å–∫–∞ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∑–Ω–∞—á–µ–Ω–∏—è, –æ—Å—Ç–∞–≤–ª—è—è –≤ –Ω—ë–º —Ç–æ–ª—å–∫–æ –∏—Ö –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è*/
				function remove_duplicates(arr){
					const seen=new Set();
					const result=[];
					// –ò–¥–µ–º –ø–æ –º–∞—Å—Å–∏–≤—É –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
					for(let i=arr.length-1;i>=0;i--){
						const value=arr[i];
						if(!seen.has(value)){
							seen.add(value);
							result.push(value);
						}
					}
					// –ü–µ—Ä–µ–≤–µ—Ä–Ω–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å –µ–≥–æ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
					return result.reverse();
				}
				/*–ø—Ä–∏–º–µ–Ω—è–µ—Ç –∫ –∏–≥—Ä–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ window.settings*/
				function apply_settings(){
					apply_language(window.settings.interface.language);
					set_font_size(window.settings.interface.font_size);
					set_max_content_size(window.settings.interface.max_content_width,window.settings.interface.max_content_height);
					change_room(room);
				}
				/*—Å–æ–∑–¥–∞–µ—Ç textarea —Å —Ä–∞–º–∫–æ–π*/
				function create_textarea_with_frame(placeholder='',removable=false){
					let textarea=create_element_from_HTML('<textarea/>');
					textarea.style.cursor='pointer';
					textarea.style.background='#00000000';
					textarea.placeholder=placeholder;
					let frame=wrap_in_frame(textarea,`<button style='background:#000;'/>`,removable);
					frame.addEventListener('click',(e)=>{
						textarea.focus();
					})
					return[frame,textarea];
				}
				/*–º—É–∑—ã–∫–∞*/
				let current_music=null;
				let current_music_path='';
				let music_volume=0.5;
				let audio_initialized=false;
				/*–¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –º—É–∑—ã–∫–∞ –Ω–∞—á–∏–Ω–∞–ª–∞ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –ª—é–±–æ–µ –º–µ—Å—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã*/
				function init_audio(){
					if(!audio_initialized){
						audio_initialized=true;
						document.removeEventListener('click',init_audio);
						if(current_music){
							current_music.play().catch(handle_play_error);
						}
					}
				}
				document.addEventListener('click',init_audio);
				/*–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø—É—Ç—å –¥–æ –º—É–∑—ã–∫–∏ –∏ –≤–∫–ª—é—á–∞–µ—Ç –µ—ë*/
				function set_music(path){
					if(current_music_path===path)return;
					if(current_music){
						current_music.pause();
						current_music=null;
					}
					current_music=new Audio(path);
					current_music.volume=music_volume;
					current_music.loop=true;
					current_music_path=path;
					if(audio_initialized){
						current_music.play().catch(handle_play_error);
					}
					console.log(`ùÑû —Å–µ–π—á–∞—Å –∏–≥—Ä–∞–µ—Ç: ${path} ‚ô´`);
				}
				/*–≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –≤ —Å–ª—É—á–∞–µ –µ—ë –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è*/
				function handle_play_error(error){
					console.error('Playback error:',error);
				}
				/*—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≥—Ä–æ–º–∫–æ—Å—Ç—å*/
				function set_volume(volume){
					music_volume=Math.max(0,Math.min(1,volume));
					if(current_music)current_music.volume=music_volume;
				}
				/*–º–µ–Ω—è–µ—Ç —Ç–µ–∫—Å—Ç –∫–∞—Å—Ç–æ–º–Ω–æ–π –∫–Ω–æ–ø–∫–∏*/
				function change_button_text(button,text){
					button.querySelector('#frame_content').innerHTML=get_transparent_space_text(text);
				}
				/*–æ–∂–∏–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç promise*/
				function wait_user_input() {
					return new Promise((resolve) => {
						const handler = (event) => {
							// –£–¥–∞–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –≤–≤–æ–¥–∞
							document.removeEventListener('keydown', handler);
							document.removeEventListener('click', handler);
							document.removeEventListener('mousedown', handler);
							// –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è –∏ –µ–≥–æ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –≤–∏–¥–µ
							resolve(event.key||event.type);
						};
						// –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
						document.addEventListener('keydown', handler);
						document.addEventListener('click', handler);
						document.addEventListener('mousedown', handler);
					});
				}
				/*—Ñ–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞*/
				let room_data;
				apply_language(window.settings.interface.language);
				set_max_content_size(window.settings.interface.max_content_width,window.settings.interface.max_content_height);
				change_room('main_menu');
				/*–≥–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª*/
				app.ticker.add(()=>{
					document.title=`CODERROR ${window.version} FPS: ${app.ticker.FPS.toFixed(2)}`;
					if(room=='main_menu'){
						if(preparation){
							set_music('music/main_menu.ogg');
							room_data={
								info:create_element_from_HTML(`<div>${get_transparent_space_text(`CODERROR ${window.version} by essensuOFnull`,'#c8c8c8')}</div>`),
								logo:create_element_from_HTML(`<div class="center-horizontal">${get_transparent_space_text(String.raw`
/T\ /T\ PT\ P] PT\ PT\ /T\ PT\
L U L q L q H  L q L q L q L q
L   L q L q H] L_/ L_/ L q L_/
L n L q L q H  U n U n L q U n
\_/ \_/ L_/ L] U U U U \_/ U U`.trim())}</div>`),
								buttons_div:create_element_from_HTML(`<div class="center column"/>`),
								buttons:dict_to_buttons(window.language.rooms[room].buttons),
								bug_counter:0
							};
							overlay.appendChild(room_data.info);
							overlay.appendChild(room_data.logo);
							change_button_color(room_data.buttons.exit,'#f00');
							Object.entries(room_data.buttons).forEach(([name,el])=>{
								room_data.buttons_div.appendChild(el);
								room_data.buttons_div.appendChild(get_br());
							});
							overlay.appendChild(room_data.buttons_div);
							room_data.buttons.exit.addEventListener('click',()=>{
								alert("‚ö†Ô∏è ERROR 400: Bad Request");
								self.close();
							});
							room_data.buttons.authors.addEventListener('click',()=>{
								change_room('authors');
							});
							room_data.buttons.settings.addEventListener('click',()=>{
								change_room('settings');
							});
							preparation=false;
						}
						visual_effect(0);
						room_data.logo.firstChild.style.color=get_random_true_str_color();
						Object.entries(room_data.buttons).forEach(([name,el])=>{
							if(name=='exit'){
								el.style.marginLeft=`calc(var(--symbol_size) * ${-0.5+Math.floor(Math.random()*2)})`;
								if(check_hover(el)){
									visual_effect(1);
									room_data.bug_counter=100;
								}
								else{
									if(room_data.bug_counter<=0){
										visual_effect(2);
									}
									else{
										room_data.bug_counter--;
									}
								}
							}
							else{
								if(check_hover(el)){
									change_button_color(el,get_random_true_str_color());
								}
								else{
									change_button_color(el,'#fff');
								}
							}
						});
					}
					if(room=='authors'){
						if(preparation){
							room_data={
								scrollable:create_element_from_HTML(`<div class="scrollable"/>`),
								div1:create_element_from_HTML(`<div class="center column"/>`),
								contribution:structuredClone(Object.entries(window.language.contribution)),
								div2:create_element_from_HTML(`<div class="center column"/>`),
								buttons:{
									back:create_button_from_text(`–Ω–∞–∑–∞–¥`)
								},
							};
							overlay.appendChild(room_data.scrollable);
							room_data.scrollable.appendChild(room_data.div1);
							room_data.contribution.forEach(([name,contribution],i)=>{
								room_data.contribution[i]=create_element_from_HTML(`<div>${get_transparent_space_text(`${name}‚¶ëreset‚¶í - ${contribution}`)}</div>`);
								room_data.div1.appendChild(get_br());
								room_data.div1.appendChild(room_data.contribution[i]);
							});
							overlay.appendChild(room_data.div2);
							room_data.div2.appendChild(room_data.buttons.back);
							room_data.buttons.back.addEventListener('click',()=>{
								change_room('main_menu');
							});
							preparation=false;
						}
						visual_effect(0);
						if(check_hover(room_data.buttons.back)){
							change_button_color(room_data.buttons.back,get_random_true_str_color());
						}
						else{
							change_button_color(room_data.buttons.back,'#fff');
						}
							
					}
					if(room=='settings'){
						if(preparation){
							room_data={
								scrollable:create_element_from_HTML(`<div class='scrollable'/>`),
								div1:create_element_from_HTML(`<div class="center column"/>`),
								drop_zone:wrap_in_frame(create_element_from_HTML(`<div class='drop_zone center'><div style='text-align:center;'>${get_transparent_space_text(window.language.rooms[room].drop_zone)}</div></div>`)),
								div2:create_element_from_HTML(`<div class="center wrap"/>`),
								buttons:dict_to_buttons(window.language.rooms[room].buttons),
								settings_divs:{},
							};
							/*–ø—Ä–µ–¥—Å–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ç–∫–∏*/
							overlay.appendChild(room_data.scrollable);
							room_data.scrollable.appendChild(room_data.div1);
							room_data.div1.appendChild(room_data.drop_zone);
							room_data.div1.appendChild(get_br());
							Object.entries(window.language.settings).forEach(([section_id,section])=>{
								room_data.div1.appendChild(get_symbolic_hr());
								room_data.div1.appendChild(create_element_from_HTML(`<div>${get_transparent_space_text(section.name)}</div>`));
								room_data.div1.appendChild(get_symbolic_hr());
								room_data.div1.appendChild(get_br());
								room_data.settings_divs[section_id]={};
								Object.entries(section.options).forEach(([option_id,option])=>{
									room_data.settings_divs[section_id][option_id]=create_element_from_HTML(`<div class='center'></div>`);
									room_data.settings_divs[section_id][option_id].appendChild(create_element_from_HTML(`<div>${get_transparent_space_text(`${option.name}: `)}</div>`));
									/*–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏*/
									let values=create_element_from_HTML(`<div id='values'></div>`);
									room_data.settings_divs[section_id][option_id].appendChild(values);
									if(section_id=='interface'){
										if(option_id=='language'){
											let add_button=create_button_from_text(window.language.rooms[room].button_add);
											change_button_text_color(add_button,'#0f0');
											values.appendChild(add_button);
											const create_select=()=>{
												let[select_button,select]=create_select_with_frame(Object.keys(window.languages).filter(name=>name!=='default'),true);
												values.insertBefore(select_button,add_button);
												select_button.addEventListener('mouseover',()=>{
													change_button_border_color(select_button,'#f0f');
												});
												select_button.addEventListener('mouseout',()=>{
													change_button_border_color(select_button,'#fff');
												});
												return select;
											}
											for(let language of window.settings.interface.language){
												create_select().value=language;
											}
											add_button.addEventListener('click',()=>{
												create_select();
											});
											add_button.addEventListener('mouseover',()=>{
												change_button_border_color(add_button,'#f0f');
											});
											add_button.addEventListener('mouseout',()=>{
												change_button_border_color(add_button,'#fff');
											});
										}
										if(['font_size','max_content_width','max_content_height'].includes(option_id)){
											let[frame,textarea]=create_textarea_with_frame(option.placeholder);
											textarea.value=window.settings[section_id][option_id];
											textarea.addEventListener('input',(e)=>{
												window.settings[section_id][option_id]=e.target.value;
											});
											values.appendChild(frame);
											frame.addEventListener('mouseover',()=>{
												change_button_border_color(frame,'#f0f');
											});
											frame.addEventListener('mouseout',()=>{
												change_button_border_color(frame,'#fff');
											});
										}
									}
									if(section_id=='audio'){
										if(option_id=='music_volume'){
											let range_input=create_element_from_HTML(`<input type="range" min="0" max="1" step="0.01" value="${window.settings[section_id][option_id]}"/>`);
											range_input.addEventListener('input',()=>{
												range_input.setAttribute('value',range_input.value);
												set_volume(range_input.value);
												window.settings[section_id][option_id]=range_input.value;
											});
											values.appendChild(range_input);
										}
									}
									if(section_id=='control'){
										let add_button=create_button_from_text(window.language.rooms[room].button_add);
										change_button_text_color(add_button,'#0f0');
										values.appendChild(add_button);
										const create_button=(text)=>{
											let button=create_button_from_text(text,true);
											button.value=text;
											values.insertBefore(button,add_button);
											button.addEventListener('mouseover',()=>{
												change_button_border_color(button,'#f0f');
											});
											button.addEventListener('mouseout',()=>{
												change_button_border_color(button,'#fff');
											});
											button.addEventListener('click',()=>{
												change_button_text(button,window.language.rooms[room].messages.input);
												setTimeout(()=>{
													wait_user_input().then((result)=>{
														change_button_text(button,result);
														button.value=result;
													});
												},100);
											});
											return button;
										}
										for(let control of window.settings[section_id][option_id]){
											create_button(control);
										}
										add_button.addEventListener('click',()=>{
											create_button().click();
										});
										add_button.addEventListener('mouseover',()=>{
											change_button_border_color(add_button,'#f0f');
										});
										add_button.addEventListener('mouseout',()=>{
											change_button_border_color(add_button,'#fff');
										});
									}
									/**/
									room_data.div1.appendChild(room_data.settings_divs[section_id][option_id]);
									room_data.div1.appendChild(get_br());
								});
							});
							/*–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞*/
							overlay.appendChild(room_data.div2);
							room_data.div2.appendChild(room_data.buttons.apply);
							room_data.div2.appendChild(get_space());
							room_data.div2.appendChild(room_data.buttons.back);
							room_data.div2.appendChild(get_space());
							room_data.div2.appendChild(room_data.buttons.save);
							add_event_listener('get_json',room_data.drop_zone,(data)=>{
								window.settings=smart_merge([window.settings,data],9);
								apply_settings();
							});
							room_data.buttons.back.addEventListener('click',()=>{
								change_room('main_menu');
							});
							room_data.buttons.save.addEventListener('click',()=>{
								save_as_json(window.settings,'settings.json');
							});
							room_data.buttons.apply.addEventListener('click',()=>{
								let language_list=[];
								for(let select of room_data.settings_divs.interface.language.querySelectorAll('select')){
									language_list.push(select.value);
								}
								language_list=remove_duplicates(language_list);
								window.settings.interface.language=language_list;
								for(let[option_id,option]of Object.entries(room_data.settings_divs.control)){
									let control_list=[];
									for(button of option.querySelectorAll('button')){
										if(button.value){
											control_list.push(button.value);
										}
									}
									window.settings.control[option_id]=remove_duplicates(control_list);
								}
								apply_settings();
							});
							preparation=false;
						}
						visual_effect(0);
						if(check_hover(room_data.drop_zone)){
							change_button_border_color(room_data.drop_zone,'#f0f');
						}
						else{
							change_button_border_color(room_data.drop_zone,'#fff');
						}
						Object.entries(room_data.buttons).forEach(([name,el])=>{
							if(check_hover(el)){
								change_button_color(el,get_random_true_str_color());
							}
							else{
								change_button_color(el,'#fff');
							}
						});
					}
					window.PERMITTED={ 
						set_font_size,
						apply_language,
						set_max_content_size
					};
				});
				app.ticker.maxFPS=60;
			}).catch(console.error);
		})
		.catch((error)=>{
			console.error(error);
		});
	}).catch(function(error){
		console.error('Font loading failed:',error);
	});
}
	</script>
</body>
</html>